import{c as te,r as H,u as se,d as U,e as O,l as Y,a as fe,b as ve,g as Z,h as ee}from "./index-381562eb.js";import{d as K,r as ae,a as S,g as L,o as i,c as l,F as N,b as z,n as j,u as D,e as n,f as w,t as B,G as q,i as _e,j as ge,k as he,w as G,H as ye}from "./index-e78cef0b.js";const xe={key:0,class:"flex flex-column p-3"},$e={class:"flex flex-column my-3"},Te=n("label",{class:"text-primary",for:"content"},"Content",-1),ke=["onClick"],we={class:"flex flex-column"},be=n("span",{class:"text-primary"},"Title",-1),De={class:"text-black-alpha-90"},Ie={class:"flex flex-column my-3"},Ce=n("span",{class:"text-primary"},"Content",-1),Le={class:"text-black-alpha-90"},Ve={class:"flex flex-column"},Ee=n("span",{class:"text-primary"},"Deadline",-1),Ae={class:"text-black-alpha-90"},Se={class:"flex justify-content-between align-items-center"},Be={key:0,class:"flex align-items-center p-3"},Ue=["onClick"],Me=["onClick"],je={key:1,class:"flex align-items-center p-3"},Ne=["onClick"],Fe=["onClick"],Pe=["onClick"],ze=["onClick"],Oe={key:2,class:"flex align-items-center p-3"},qe=n("span",{class:"border-2 border-round-xl p-2 bg-green-800 border-green-800"},"Done",-1),Je=[qe],Re={key:3,class:"flex align-items-center p-3"},Ge=n("span",{class:"border-2 border-round-xl p-2 bg-orange-800 border-orange-800"},"In progress",-1),He=[Ge],Ke={key:0,class:"flex"},Qe=K({__name:"TheTodos",props:{listId:null,listsData:null,todosData:null,filtering:{type:Boolean}},emits:["deleteTodo","createTodo","isEditingTodo","updateTodo","doneTodo"],setup(g, {emit:h}){const m=g,F={collection:{$each:te.forEach({title:{required:H},deadline:{required:H}})}},M=ae({collection:m.todosData}),o=se(F,M),P=async()=>await o.value.$validate(),u=S(m.todosData),E=(d, y)=>{h("deleteTodo",{listId:d,todoId:y})},b= d=>{h("createTodo",d)},C=(d, y)=>{const I=U(m.listsData,d),_=O(m.todosData,y);m.todosData[_].is_adding_todo?E(d,y):h("isEditingTodo",{listIndex:I,todoIndex:_,is_editing_todo:!m.todosData[_].is_editing_todo})},T=async(d, y)=>{const I=U(m.listsData,d),_=O(m.todosData,y);await P()&&h("updateTodo",{listIndex:I,listId:d,todoIndex:_,todoId:y,newTodo:u.value[_]})},x=(d, y)=>{const I=U(m.listsData,d),_=O(m.todosData,y);h("doneTodo",{listIndex:I,listId:d,todoIndex:_,todoId:y,is_done_todo:!m.todosData[_].is_done_todo})};return(d, y)=>{const I=L("InputText"),_=L("TheTextarea"),p=L("TheCalendar"),c=L("TheButton");return i(),l(N,null,[(i(!0),l(N,null,z(g.todosData,(s, f)=>(i(),l("div",{key:s.id,class:j([{errorTitle:D(o).collection.$each.$response.$errors[f].title.length,errorDeadline:D(o).collection.$each.$response.$errors[f].deadline.length},"flex flex-column justify-content-between bg-gray-300 border-round-xl m-3"])},[s!=null&&s.is_editing_todo?(i(),l("div",xe,[n("label",{class:j([{"p-error":D(o).collection.$each.$response.$errors[f].title.length},"text-primary"]),for:"title"},"Title*",2),w(I,{id:"title",modelValue:u.value[f].title,"onUpdate:modelValue": a=>u.value[f].title=a,class:j({"p-invalid":D(o).collection.$each.$response.$errors[f].title.length}),placeholder:"Add title for todo",type:"text"},null,8,["modelValue","onUpdate:modelValue","class"]),(i(!0),l(N,null,z(D(o).collection.$each.$response.$errors[f].title, a=>(i(),l("div",{key:a,class:"p-error"},B(a.$message.replace("Value","Title")),1))),128)),n("div",$e,[Te,w(_,{id:"content",modelValue:u.value[f].content,"onUpdate:modelValue": a=>u.value[f].content=a,"auto-resize":!0,cols:"30",placeholder:"Add content for todo",rows:"5"},null,8,["modelValue","onUpdate:modelValue"])]),n("label",{class:j([{"p-error":D(o).collection.$each.$response.$errors[f].deadline.length},"text-primary"]),for:"deadline"},"Deadline*",2),w(p,{id:"deadline",modelValue:u.value[f].deadline,"onUpdate:modelValue":[a=>u.value[f].deadline=a, a=>D(Y)(u.value[f].deadline)],class:j({"p-invalid":D(o).collection.$each.$response.$errors[f].deadline.length}),"date-format":"dd.mm.yy",placeholder:"Add deadline for todo","show-time":""},null,8,["modelValue","onUpdate:modelValue","class"]),(i(!0),l(N,null,z(D(o).collection.$each.$response.$errors[f].deadline, a=>(i(),l("div",{key:a,class:"p-error"},B(a.$message.replace("Value","Deadline")),1))),128))])):(i(),l("div",{key:1,class:"flex flex-column p-3 cursor-pointer",onClick: a=>C(g.listId,s==null?void 0:s.id)},[n("div",we,[be,n("h3",De,B(s==null?void 0:s.title),1)]),n("div",Ie,[Ce,n("p",Le,B(s==null?void 0:s.content),1)]),n("div",Ve,[Ee,n("p",Ae,B(D(Y)(s==null?void 0:s.deadline)),1)])],8,ke)),n("div",Se,[s!=null&&s.is_editing_todo?(i(),l("div",Be,[n("i",{class:"pi pi-check cursor-pointer text-primary",onClick: a=>T(g.listId,s==null?void 0:s.id)},null,8,Ue),n("i",{class:"pi pi-times cursor-pointer mx-3 text-red-800",onClick: a=>C(g.listId,s==null?void 0:s.id)},null,8,Me)])):(i(),l("div",je,[s!=null&&s.is_done_todo?(i(),l("i",{key:1,class:"pi pi-times cursor-pointer text-red-800",onClick: a=>x(g.listId,s==null?void 0:s.id)},null,8,Fe)):(i(),l("i",{key:0,class:"pi pi-check cursor-pointer text-primary",onClick: a=>x(g.listId,s==null?void 0:s.id)},null,8,Ne)),n("i",{class:"pi pi-pencil mx-3 cursor-pointer text-blue-800",onClick: a=>C(g.listId,s==null?void 0:s.id)},null,8,Pe),n("i",{class:"pi pi-trash cursor-pointer text-red-800",onClick: a=>E(g.listId,s==null?void 0:s.id)},null,8,ze)])),s!=null&&s.is_done_todo?(i(),l("div",Oe,Je)):q("",!0),!(s!=null&&s.is_adding_todo)&&!(s!=null&&s.is_done_todo)?(i(),l("div",Re,He)):q("",!0)])],2))),128)),g.filtering?q("",!0):(i(),l("div",Ke,[w(c,{class:"m-3",label:"+ Add new todo",onClick:y[0]||(y[0]= s=>b(g.listId))})]))],64)}}}),We={class:"flex justify-content-between"},Xe={key:0,class:"flex flex-column p-3"},Ye={key:1,class:"flex flex-column p-3"},Ze=n("span",{class:"text-primary"},"Name",-1),et=["onClick"],tt={key:2,class:"flex align-items-center px-3"},st=["onClick"],at=["onClick"],ot={key:3,class:"flex align-items-center px-3"},nt=["onClick"],it=["onClick"],lt={key:0,class:"flex flex-column"},dt=K({__name:"TheLists",props:{listsData:null,filtering:{type:Boolean}},emits:["deleteList","createList","isEditingList","updateList","deleteTodo","createTodo","isEditingTodo","updateTodo","doneTodo"],setup(g, {emit:h}){const m=g,F={collection:{$each:te.forEach({name:{required:H}})}},M=ae({collection:m.listsData}),o=se(F,M),P=async()=>await o.value.$validate(),u=S(m.listsData),E= p=>{h("deleteList",p)},b=()=>{h("createList")},C= p=>{const c=U(m.listsData,p);m.listsData[c].is_adding_list?E(p):h("isEditingList",{listIndex:c,is_editing_list:!m.listsData[c].is_editing_list})},T=async p=>{const c=U(m.listsData,p);await P()&&h("updateList",{listIndex:c,listId:p,newList:u.value[c]})},x= p=>{h("deleteTodo",p)},d= p=>{h("createTodo",p)},y= p=>{h("isEditingTodo",p)},I= p=>{h("updateTodo",p)},_= p=>{h("doneTodo",p)};return(p, c)=>{const s=L("InputText"),f=L("TheButton");return i(),l(N,null,[(i(!0),l(N,null,z(g.listsData,(a, k)=>(i(),l("div",{key:a.id,class:j([{errorName:D(o).collection.$each.$response.$errors[k].name.length},"flex flex-column bg-gray-200 border-round-xl m-3 w-30rem"])},[n("div",We,[a!=null&&a.is_editing_list?(i(),l("div",Xe,[n("label",{class:j([{"p-error":D(o).collection.$each.$response.$errors[k].name.length},"text-primary"]),for:"name"},"Name*",2),w(s,{modelValue:u.value[k].name,"onUpdate:modelValue": v=>u.value[k].name=v,placeholder:"Add name for list",type:"text"},null,8,["modelValue","onUpdate:modelValue"]),(i(!0),l(N,null,z(D(o).collection.$each.$response.$errors[k].name, v=>(i(),l("div",{key:v,class:"p-error"},B(v.$message.replace("Value","Title")),1))),128))])):(i(),l("div",Ye,[Ze,n("h2",{class:"cursor-pointer text-black-alpha-90",onClick: v=>C(a==null?void 0:a.id)},B(a==null?void 0:a.name),9,et)])),a!=null&&a.is_editing_list?(i(),l("div",tt,[n("i",{class:"pi pi-check mx-3 cursor-pointer text-primary",onClick: v=>T(a==null?void 0:a.id)},null,8,st),n("i",{class:"pi pi-times cursor-pointer text-red-800",onClick: v=>C(a==null?void 0:a.id)},null,8,at)])):(i(),l("div",ot,[n("i",{class:"pi pi-pencil mx-3 cursor-pointer text-blue-800",onClick: v=>C(a==null?void 0:a.id)},null,8,nt),n("i",{class:"pi pi-trash cursor-pointer text-red-800",onClick: v=>E(a==null?void 0:a.id)},null,8,it)]))]),w(Qe,{filtering:g.filtering,"list-id":parseInt(a==null?void 0:a.id.toString()),"lists-data":g.listsData,"todos-data":a==null?void 0:a.todos,onDeleteTodo:c[0]||(c[0]= v=>x(v)),onCreateTodo:c[1]||(c[1]= v=>d(v)),onIsEditingTodo:c[2]||(c[2]= v=>y(v)),onUpdateTodo:c[3]||(c[3]= v=>I(v)),onDoneTodo:c[4]||(c[4]= v=>_(v))},null,8,["filtering","list-id","lists-data","todos-data"])],2))),128)),g.filtering?q("",!0):(i(),l("div",lt,[w(f,{class:"m-3",label:"+ Add new list",onClick:c[5]||(c[5]= a=>b())})]))],64)}}}),ct={class:"flex flex-column"},rt={class:"flex justify-content-between align-items-center py-3 px-5 bg-cadet-blue"},ut=n("h1",{class:"text-white-alpha-50"},"todo app",-1),pt={class:"mx-3"},mt=n("div",null,null,-1),ft={class:"py-3 px-5 absolute right-0 z-1"},vt={class:"flex flex-column"},_t={class:"p-input-icon-left"},gt=n("i",{class:"pi pi-search z-1"},null,-1),ht={class:"field-checkbox my-3"},yt=n("label",{for:"done"},"Done",-1),xt={class:"field-checkbox"},$t=n("label",{for:"inProgress"},"In progress",-1),Tt={class:"flex flex-wrap p-3"},bt=K({__name:"BoardPage",async setup(g){let h,m;const F=fe(),M=S({}),o=S([]),P=ye(),u=parseInt(P.params.id),E=_e(),b=ge(),C=S(!1),T=S(""),x=S(!1),d=S(!1),y=()=>{F.setLists(u,o.value)},I=async()=>await(await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${u}/lists`)).json(),_=async()=>{try{const e=await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${u}`);M.value=await e.json(),o.value=await I(),y()}catch(e){C.value||b.add({severity:"error",summary:"Error Message",detail:e,life:3e3})}},p=async()=>{const e=await I(),t=Z(u).value,$=ee(e.map(A=>A.todos)),V=ee(t.map(A=>A.todos));return e.length!==t.length||$.length!==V.length},c=async()=>{await p()?await _():(M.value=ve().value.find(e=>e.id==u),o.value=Z(u).value)},s=()=>{o.value.forEach((e, t)=>{o.value[t].todos=e.todos.filter(({title:$,content:V,deadline:A})=>[$,V,new Date(A).toLocaleString("sk-SK")].some(R=>R.toLowerCase().includes(T.value.toLowerCase())))})},f=()=>{o.value.forEach((e, t)=>{o.value[t].todos=e.todos.filter(({is_done_todo:$})=>[$].some(V=>V===x.value))})},a=()=>{o.value.forEach((e, t)=>{o.value[t].todos=e.todos.filter(({is_done_todo:$})=>[$].some(V=>!V===d.value))})},k=async()=>{C.value=!0,await c(),T.value!==""&&!x.value&&!d.value?s():T.value===""&&x.value&&!d.value?f():T.value===""&&!x.value&&d.value?a():T.value===""&&x.value&&d.value?(f(),a()):T.value!==""&&x.value&&!d.value?(s(),f()):T.value!==""&&!x.value&&d.value?(s(),a()):T.value!==""&&x.value&&d.value&&s()},v=async e=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${u}/lists/${e}`,{method:"DELETE"}),b.add({severity:"success",summary:"Success Message",detail:"List deleted successfully",life:3e3})}catch(t){b.add({severity:"error",summary:"Error Message",detail:t,life:3e3})}},oe=async e=>{await E.require({message:"Are you sure you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:async()=>{const t=U(o.value,e);o.value.splice(t,1),await v(e),await _(),await k()},reject:()=>{}})},ne=async()=>{o.value.push({id:o.value.length+1,boardId:u,name:"",is_adding_list:!0,is_editing_list:!1,todos:[]});const e=o.value.length-1;await Q({listIndex:e,is_editing_list:!0})},Q=async e=>{o.value[e.listIndex].is_editing_list=e.is_editing_list,e.is_editing_list||await c()},ie=async e=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${u}/lists`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o.value[e.listIndex].name})}),b.add({severity:"success",summary:"Success Message",detail:"List created successfully",life:3e3})}catch(t){b.add({severity:"error",summary:"Error Message",detail:t,life:3e3})}},le=async e=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${u}/lists/${e.listId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value[e.listIndex])}),b.add({severity:"success",summary:"Success Message",detail:"List updated successfully",life:3e3})}catch(t){b.add({severity:"error",summary:"Error Message",detail:t,life:3e3})}},de=async e=>{o.value[e.listIndex]=e.newList,o.value[e.listIndex].is_editing_list=!1,o.value[e.listIndex].is_adding_list?(o.value[e.listIndex].is_adding_list=!1,await ie(e)):await le(e),await _(),await k()},J=async(e, t)=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${u}/lists/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value[t])}),b.add({severity:"success",summary:"Success Message",detail:"Todo updated successfully",life:3e3})}catch($){b.add({severity:"error",summary:"Error Message",detail:$,life:3e3})}},ce=async e=>{await E.require({message:"Are you sure you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:async()=>{const t=U(o.value,e.listId),$=O(o.value[t].todos,e.todoId);o.value[t].todos.splice($,1),await J(e.listId,t),await _(),await k()},reject:()=>{}})},re=async e=>{const t=U(o.value,e);o.value[t].todos.push({id:o.value[t].todos.length+1,title:"",content:"",deadline:"",is_adding_todo:!0,is_editing_todo:!1,is_done_todo:!1});const $=o.value[t].todos.length-1;await W({listIndex:t,todoIndex:$,is_editing_todo:!0})},W=async e=>{o.value[e.listIndex].todos[e.todoIndex].is_editing_todo=e.is_editing_todo,e.is_editing_todo||await c()},ue=async e=>{o.value[e.listIndex].todos[e.todoIndex]=e.newTodo,o.value[e.listIndex].todos[e.todoIndex].is_adding_todo=!1,o.value[e.listIndex].todos[e.todoIndex].is_editing_todo=!1,await J(e.listId,e.listIndex),await _(),await k()},pe=async e=>{o.value[e.listIndex].todos[e.todoIndex].is_done_todo=e.is_done_todo,await J(e.listId,e.listIndex),await _(),await k()};return[h,m]=he(()=>c()),await h,m(),(e, t)=>{var X;const $=L("RouterLink"),V=L("InputText"),A=L("TheCheckbox"),R=L("AccordionTab"),me=L("TheAccordion");return i(),l("div",ct,[n("div",rt,[w($,{class:"no-underline",to:"/"},{default:G(()=>[ut]),_:1}),n("h1",pt,B((X=M.value)==null?void 0:X.title),1),mt]),n("div",ft,[w(me,null,{default:G(()=>[w(R,{header:"Filter"},{default:G(()=>[n("div",vt,[n("span",_t,[gt,w(V,{modelValue:T.value,"onUpdate:modelValue":t[0]||(t[0]= r=>T.value=r),placeholder:"Search",type:"text",onInput:t[1]||(t[1]= r=>k())},null,8,["modelValue"])]),n("div",ht,[w(A,{modelValue:x.value,"onUpdate:modelValue":t[2]||(t[2]= r=>x.value=r),binary:!0,"input-id":"done",onInput:t[3]||(t[3]= r=>k())},null,8,["modelValue"]),yt]),n("div",xt,[w(A,{modelValue:d.value,"onUpdate:modelValue":t[4]||(t[4]= r=>d.value=r),binary:!0,"input-id":"inProgress",onInput:t[5]||(t[5]= r=>k())},null,8,["modelValue"]),$t])])]),_:1})]),_:1})]),n("div",Tt,[w(dt,{filtering:C.value,"lists-data":o.value,onDeleteList:t[6]||(t[6]= r=>oe(r)),onCreateList:t[7]||(t[7]= r=>ne()),onIsEditingList:t[8]||(t[8]= r=>Q(r)),onUpdateList:t[9]||(t[9]= r=>de(r)),onDeleteTodo:t[10]||(t[10]= r=>ce(r)),onCreateTodo:t[11]||(t[11]= r=>re(r)),onIsEditingTodo:t[12]||(t[12]= r=>W(r)),onUpdateTodo:t[13]||(t[13]= r=>ue(r)),onDoneTodo:t[14]||(t[14]= r=>pe(r))},null,8,["filtering","lists-data"])])])}}});export{bt as default};
