import{c as ae,r as X,u as G,d as A,e as J,g as H,l as ge,a as he,b as xe,h as se,i as oe}from "./index-66abeba9.js";import{d as Y,r as ie,a as B,w as ne,g as E,o as r,c as u,F as P,b as q,n as F,u as C,e as a,f as D,t as U,G as R,j as ye,k as Te,l as $e,i as W,H as ke}from "./index-26005f5d.js";const we={key:0,class:"flex flex-column p-3"},De={class:"flex flex-column my-3"},be=a("label",{class:"text-primary",for:"content"},"Content",-1),Ie=["onClick"],Ce={class:"flex flex-column"},Le=a("span",{class:"text-primary"},"Title",-1),Ee={class:"text-black-alpha-90"},Ve={class:"flex flex-column my-3"},Ae=a("span",{class:"text-primary"},"Content",-1),Ne={class:"text-black-alpha-90"},Se={class:"flex flex-column"},Be=a("span",{class:"text-primary"},"Deadline",-1),Ue={class:"text-black-alpha-90"},Me={class:"flex justify-content-between align-items-center"},je={key:0,class:"flex align-items-center p-3"},Fe=["onClick"],Pe=["onClick"],ze={key:1,class:"flex align-items-center p-3"},Oe=["onClick"],qe=["onClick"],Je=["onClick"],Re=["onClick"],Ge={key:2,class:"flex align-items-center p-3"},He=a("span",{class:"border-2 border-round-xl p-2 bg-green-800 border-green-800"},"Done",-1),Ke=[He],Qe={key:3,class:"flex align-items-center p-3"},We=a("span",{class:"border-2 border-round-xl p-2 bg-orange-800 border-orange-800"},"In progress",-1),Xe=[We],Ye={key:0,class:"flex"},Ze=Y({__name:"TheTodos",props:{listId:null,listsData:null,todosData:null,filtering:{type:Boolean}},emits:["deleteTodo","createTodo","closeEditingNewTodo","isEditingTodo","updateTodo","doneTodo"],setup(f, {emit:m}){const n=f,M={collection:{$each:ae.forEach({title:{required:X},deadline:{required:X}})}},L=ie({collection:n.todosData});let o=G(M,L);const O=async()=>await o.value.$validate(),p=B(n.todosData),z=(h, x)=>{m("deleteTodo",{listId:h,todoId:x})},b= h=>{m("createTodo",h)},I= h=>{m("closeEditingNewTodo",h)},g=(h, x)=>{const y=A(n.listsData,h),T=J(n.todosData,x);n.todosData[H(n.todosData)].is_adding_todo?I(y):m("isEditingTodo",{listIndex:y,todoIndex:T,is_editing_todo:!n.todosData[T].is_editing_todo})},w=async(h, x)=>{const y=A(n.listsData,h);let T=J(n.todosData,x);n.todosData[T].is_editing_todo||(T=x-1),await O()&&m("updateTodo",{listIndex:y,listId:h,todoIndex:T,todoId:x,newTodo:p.value[T]})},$=(h, x)=>{const y=A(n.listsData,h),T=J(n.todosData,x);m("doneTodo",{listIndex:y,listId:h,todoIndex:T,todoId:x,is_done_todo:!n.todosData[T].is_done_todo})};return ne(()=>n.todosData,()=>{p.value=n.todosData,L.collection=n.todosData,o=G(M,L)}),(h, x)=>{const y=E("InputText"),T=E("TheTextarea"),N=E("TheCalendar"),c=E("TheButton");return r(),u(P,null,[(r(!0),u(P,null,q(f.todosData,(e, _)=>(r(),u("div",{key:e.id,class:F([{errorTitle:C(o).collection.$each.$response.$errors[_].title.length,errorDeadline:C(o).collection.$each.$response.$errors[_].deadline.length},"flex flex-column justify-content-between bg-gray-300 border-round-xl m-3"])},[e!=null&&e.is_editing_todo?(r(),u("div",we,[a("label",{class:F([{"p-error":C(o).collection.$each.$response.$errors[_].title.length},"text-primary"]),for:"title"},"Title*",2),D(y,{id:"title",modelValue:p.value[_].title,"onUpdate:modelValue": l=>p.value[_].title=l,class:F({"p-invalid":C(o).collection.$each.$response.$errors[_].title.length}),placeholder:"Add title for todo",type:"text"},null,8,["modelValue","onUpdate:modelValue","class"]),(r(!0),u(P,null,q(C(o).collection.$each.$response.$errors[_].title, l=>(r(),u("div",{key:l,class:"p-error"},U(l.$message.replace("Value","Title")),1))),128)),a("div",De,[be,D(T,{id:"content",modelValue:p.value[_].content,"onUpdate:modelValue": l=>p.value[_].content=l,"auto-resize":!0,cols:"30",placeholder:"Add content for todo",rows:"5"},null,8,["modelValue","onUpdate:modelValue"])]),a("label",{class:F([{"p-error":C(o).collection.$each.$response.$errors[_].deadline.length},"text-primary"]),for:"deadline"},"Deadline*",2),D(N,{id:"deadline",modelValue:p.value[_].deadline,"onUpdate:modelValue": l=>p.value[_].deadline=l,class:F({"p-invalid":C(o).collection.$each.$response.$errors[_].deadline.length}),"date-format":"dd.mm.yy",placeholder:"Add deadline for todo","show-time":""},null,8,["modelValue","onUpdate:modelValue","class"]),(r(!0),u(P,null,q(C(o).collection.$each.$response.$errors[_].deadline, l=>(r(),u("div",{key:l,class:"p-error"},U(l.$message.replace("Value","Deadline")),1))),128))])):(r(),u("div",{key:1,class:"flex flex-column p-3 cursor-pointer",onClick: l=>g(f.listId,e==null?void 0:e.id)},[a("div",Ce,[Le,a("h3",Ee,U(e==null?void 0:e.title),1)]),a("div",Ve,[Ae,a("p",Ne,U(e==null?void 0:e.content),1)]),a("div",Se,[Be,a("p",Ue,U(C(ge)(e==null?void 0:e.deadline)),1)])],8,Ie)),a("div",Me,[e!=null&&e.is_editing_todo?(r(),u("div",je,[a("i",{class:"pi pi-check cursor-pointer text-primary",onClick: l=>w(f.listId,e==null?void 0:e.id)},null,8,Fe),a("i",{class:"pi pi-times cursor-pointer mx-3 text-red-800",onClick: l=>g(f.listId,e==null?void 0:e.id)},null,8,Pe)])):(r(),u("div",ze,[e!=null&&e.is_done_todo?(r(),u("i",{key:1,class:"pi pi-times cursor-pointer text-red-800",onClick: l=>$(f.listId,e==null?void 0:e.id)},null,8,qe)):(r(),u("i",{key:0,class:"pi pi-check cursor-pointer text-primary",onClick: l=>$(f.listId,e==null?void 0:e.id)},null,8,Oe)),a("i",{class:"pi pi-pencil mx-3 cursor-pointer text-blue-800",onClick: l=>g(f.listId,e==null?void 0:e.id)},null,8,Je),a("i",{class:"pi pi-trash cursor-pointer text-red-800",onClick: l=>z(f.listId,e==null?void 0:e.id)},null,8,Re)])),e!=null&&e.is_done_todo?(r(),u("div",Ge,Ke)):R("",!0),!(e!=null&&e.is_adding_todo)&&!(e!=null&&e.is_done_todo)?(r(),u("div",Qe,Xe)):R("",!0)])],2))),128)),!f.listsData[C(A)(f.listsData,f.listId)].is_adding_list&&!f.filtering?(r(),u("div",Ye,[D(c,{class:"m-3",label:"+ Add new todo",onClick:x[0]||(x[0]= e=>b(f.listId))})])):R("",!0)],64)}}}),et={class:"flex justify-content-between"},tt={key:0,class:"flex flex-column p-3"},st={key:1,class:"flex flex-column p-3"},ot=a("span",{class:"text-primary"},"Name",-1),at=["onClick"],it={key:2,class:"flex align-items-center px-3"},nt=["onClick"],lt=["onClick"],dt={key:3,class:"flex align-items-center px-3"},ct=["onClick"],rt=["onClick"],ut={key:0,class:"flex flex-column"},pt=Y({__name:"TheLists",props:{listsData:null,filtering:{type:Boolean}},emits:["deleteList","createList","closeEditingNewList","isEditingList","updateList","deleteTodo","createTodo","closeEditingNewTodo","isEditingTodo","updateTodo","doneTodo"],setup(f, {emit:m}){const n=f,M={collection:{$each:ae.forEach({name:{required:X}})}},L=ie({collection:n.listsData});let o=G(M,L);const O=async()=>await o.value.$validate(),p=B(n.listsData),z= c=>{m("deleteList",c)},b=()=>{m("createList")},I=()=>{m("closeEditingNewList")},g= c=>{const e=A(n.listsData,c);n.listsData[H(n.listsData)].is_adding_list?I():m("isEditingList",{listIndex:e,is_editing_list:!n.listsData[e].is_editing_list})},w=async c=>{let e=A(n.listsData,c);n.listsData[e].is_editing_list||(e=c-1),await O()&&m("updateList",{listIndex:e,listId:c,newList:p.value[e]})},$= c=>{m("deleteTodo",c)},h= c=>{m("createTodo",c)},x= c=>{m("closeEditingNewTodo",c)},y= c=>{m("isEditingTodo",c)},T= c=>{m("updateTodo",c)},N= c=>{m("doneTodo",c)};return ne(()=>n.listsData,()=>{p.value=n.listsData,L.collection=n.listsData,o=G(M,L)}),(c, e)=>{const _=E("InputText"),l=E("TheButton");return r(),u(P,null,[(r(!0),u(P,null,q(f.listsData,(i, j)=>(r(),u("div",{key:i.id,class:F([{errorName:C(o).collection.$each.$response.$errors[j].name.length},"flex flex-column bg-gray-200 border-round-xl m-3 w-30rem"])},[a("div",et,[i!=null&&i.is_editing_list?(r(),u("div",tt,[a("label",{class:F([{"p-error":C(o).collection.$each.$response.$errors[j].name.length},"text-primary"]),for:"name"},"Name*",2),D(_,{modelValue:p.value[j].name,"onUpdate:modelValue": v=>p.value[j].name=v,placeholder:"Add name for list",type:"text"},null,8,["modelValue","onUpdate:modelValue"]),(r(!0),u(P,null,q(C(o).collection.$each.$response.$errors[j].name, v=>(r(),u("div",{key:v,class:"p-error"},U(v.$message.replace("Value","Title")),1))),128))])):(r(),u("div",st,[ot,a("h2",{class:"cursor-pointer text-black-alpha-90",onClick: v=>g(i==null?void 0:i.id)},U(i==null?void 0:i.name),9,at)])),i!=null&&i.is_editing_list?(r(),u("div",it,[a("i",{class:"pi pi-check mx-3 cursor-pointer text-primary",onClick: v=>w(i==null?void 0:i.id)},null,8,nt),a("i",{class:"pi pi-times cursor-pointer text-red-800",onClick: v=>g(i==null?void 0:i.id)},null,8,lt)])):(r(),u("div",dt,[a("i",{class:"pi pi-pencil mx-3 cursor-pointer text-blue-800",onClick: v=>g(i==null?void 0:i.id)},null,8,ct),a("i",{class:"pi pi-trash cursor-pointer text-red-800",onClick: v=>z(i==null?void 0:i.id)},null,8,rt)]))]),D(Ze,{filtering:f.filtering,"list-id":parseInt(i==null?void 0:i.id.toString()),"lists-data":f.listsData,"todos-data":i==null?void 0:i.todos,onDeleteTodo:e[0]||(e[0]= v=>$(v)),onCreateTodo:e[1]||(e[1]= v=>h(v)),onCloseEditingNewTodo:e[2]||(e[2]= v=>x(v)),onIsEditingTodo:e[3]||(e[3]= v=>y(v)),onUpdateTodo:e[4]||(e[4]= v=>T(v)),onDoneTodo:e[5]||(e[5]= v=>N(v))},null,8,["filtering","list-id","lists-data","todos-data"])],2))),128)),f.filtering?R("",!0):(r(),u("div",ut,[D(l,{class:"m-3",label:"+ Add new list",onClick:e[6]||(e[6]= i=>b())})]))],64)}}}),vt={class:"flex flex-column"},ft={class:"flex justify-content-between align-items-center py-3 px-5 bg-cadet-blue"},mt=a("h1",{class:"text-white-alpha-50"},"todo app",-1),_t={class:"mx-3"},gt=a("div",null,null,-1),ht={class:"py-3 px-5 absolute right-0 z-1"},xt={class:"flex flex-column"},yt={class:"p-input-icon-left"},Tt=a("i",{class:"pi pi-search z-1"},null,-1),$t={class:"field-checkbox my-3"},kt=a("label",{for:"done"},"Done",-1),wt={class:"field-checkbox"},Dt=a("label",{for:"inProgress"},"In progress",-1),bt={class:"flex flex-wrap p-3"},Lt=Y({__name:"BoardPage",async setup(f){let m,n;const M=he(),L=B({}),o=B([]),O=ke(),p=parseInt(O.params.id),z=ye(),b=Te(),I=B(!1),g=B(""),w=B(!1),$=B(!1),h=()=>{M.setLists(p,o.value)},x=async()=>await(await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${p}/lists`)).json(),y=async()=>{try{const t=await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${p}`);L.value=await t.json(),o.value=await x(),h()}catch(t){I.value||b.add({severity:"error",summary:"Error Message",detail:t,life:3e3})}},T=async()=>{const t=await x(),s=se(p).value,k=oe(t.map(S=>S.todos)),V=oe(s.map(S=>S.todos));return t.length!==s.length||k.length!==V.length},N=async()=>{await T()?await y():(L.value=xe().value.find(t=>t.id==p),o.value=se(p).value)},c=()=>{o.value.forEach((t, s)=>{o.value[s].todos=t.todos.filter(({title:k,content:V,deadline:S})=>[k,V,new Date(S).toLocaleString("sk-SK")].some(Q=>Q.toLowerCase().includes(g.value.toLowerCase())))})},e=()=>{o.value.forEach((t, s)=>{o.value[s].todos=t.todos.filter(({is_done_todo:k})=>[k].some(V=>V===w.value))})},_=()=>{o.value.forEach((t, s)=>{o.value[s].todos=t.todos.filter(({is_done_todo:k})=>[k].some(V=>!V===$.value))})},l=async()=>{I.value=!0,await N(),g.value!==""&&!w.value&&!$.value?c():g.value===""&&w.value&&!$.value?e():g.value===""&&!w.value&&$.value?_():g.value===""&&w.value&&$.value?(e(),_()):g.value!==""&&w.value&&!$.value?(c(),e()):g.value!==""&&!w.value&&$.value?(c(),_()):g.value!==""&&w.value&&$.value?c():I.value=!1},i=async t=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${p}/lists/${t}`,{method:"DELETE"}),b.add({severity:"success",summary:"Success Message",detail:"List deleted successfully",life:3e3})}catch(s){b.add({severity:"error",summary:"Error Message",detail:s,life:3e3})}},j= t=>{z.require({message:"Are you sure you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:async()=>{const s=A(o.value,t);o.value.splice(s,1),await i(t),await y(),I.value&&await l()},reject:()=>{}})},v=async()=>{o.value.push({id:o.value.length+1,boardId:p,name:"",is_adding_list:!0,is_editing_list:!1,todos:[]});const t=H(o.value);await Z({listIndex:t,is_editing_list:!0})},le=()=>{o.value.pop()},Z=async t=>{o.value[t.listIndex].is_editing_list=t.is_editing_list,t.is_editing_list||await N()},de=async t=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${p}/lists`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o.value[t.listIndex].name})}),b.add({severity:"success",summary:"Success Message",detail:"List created successfully",life:3e3})}catch(s){b.add({severity:"error",summary:"Error Message",detail:s,life:3e3})}},ce=async t=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${p}/lists/${t.listId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value[t.listIndex])}),b.add({severity:"success",summary:"Success Message",detail:"List updated successfully",life:3e3})}catch(s){b.add({severity:"error",summary:"Error Message",detail:s,life:3e3})}},re=async t=>{o.value[t.listIndex]=t.newList,o.value[t.listIndex].is_editing_list=!1,o.value[t.listIndex].is_adding_list?(o.value[t.listIndex].is_adding_list=!1,await de(t)):await ce(t),await y(),I.value&&await l()},K=async(t, s)=>{try{await fetch(`https://63d3f5218d4e68c14eb69fe7.mockapi.io/api/v1/boards/${p}/lists/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o.value[s])}),b.add({severity:"success",summary:"Success Message",detail:"Todo updated successfully",life:3e3})}catch(k){b.add({severity:"error",summary:"Error Message",detail:k,life:3e3})}},ue= t=>{z.require({message:"Are you sure you want to proceed?",header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:async()=>{const s=A(o.value,t.listId),k=J(o.value[s].todos,t.todoId);o.value[s].todos.splice(k,1),await K(t.listId,s),await y(),I.value&&await l()},reject:()=>{}})},pe=async t=>{const s=A(o.value,t);o.value[s].todos.push({id:o.value[s].todos.length+1,title:"",content:"",deadline:"",is_adding_todo:!0,is_editing_todo:!1,is_done_todo:!1});const k=H(o.value[s].todos);await ee({listIndex:s,todoIndex:k,is_editing_todo:!0})},ve= t=>{o.value[t].todos.pop()},ee=async t=>{o.value[t.listIndex].todos[t.todoIndex].is_editing_todo=t.is_editing_todo,t.is_editing_todo||await N()},fe=async t=>{o.value[t.listIndex].todos[t.todoIndex]=t.newTodo,o.value[t.listIndex].todos[t.todoIndex].is_adding_todo=!1,o.value[t.listIndex].todos[t.todoIndex].is_editing_todo=!1,await K(t.listId,t.listIndex),await y(),I.value&&await l()},me=async t=>{o.value[t.listIndex].todos[t.todoIndex].is_done_todo=t.is_done_todo,await K(t.listId,t.listIndex),await y(),I.value&&await l()};return[m,n]=$e(()=>N()),await m,n(),(t, s)=>{var te;const k=E("RouterLink"),V=E("InputText"),S=E("TheCheckbox"),Q=E("AccordionTab"),_e=E("TheAccordion");return r(),u("div",vt,[a("div",ft,[D(k,{class:"no-underline",to:"/"},{default:W(()=>[mt]),_:1}),a("h1",_t,U((te=L.value)==null?void 0:te.title),1),gt]),a("div",ht,[D(_e,null,{default:W(()=>[D(Q,{header:"Filter"},{default:W(()=>[a("div",xt,[a("span",yt,[Tt,D(V,{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]= d=>g.value=d),placeholder:"Search",type:"text",onInput:s[1]||(s[1]= d=>l())},null,8,["modelValue"])]),a("div",$t,[D(S,{modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]= d=>w.value=d),binary:!0,"input-id":"done",onInput:s[3]||(s[3]= d=>l())},null,8,["modelValue"]),kt]),a("div",wt,[D(S,{modelValue:$.value,"onUpdate:modelValue":s[4]||(s[4]= d=>$.value=d),binary:!0,"input-id":"inProgress",onInput:s[5]||(s[5]= d=>l())},null,8,["modelValue"]),Dt])])]),_:1})]),_:1})]),a("div",bt,[D(pt,{filtering:I.value,"lists-data":o.value,onDeleteList:s[6]||(s[6]= d=>j(d)),onCreateList:s[7]||(s[7]= d=>v()),onCloseEditingNewList:s[8]||(s[8]= d=>le()),onIsEditingList:s[9]||(s[9]= d=>Z(d)),onUpdateList:s[10]||(s[10]= d=>re(d)),onDeleteTodo:s[11]||(s[11]= d=>ue(d)),onCreateTodo:s[12]||(s[12]= d=>pe(d)),onCloseEditingNewTodo:s[13]||(s[13]= d=>ve(d)),onIsEditingTodo:s[14]||(s[14]= d=>ee(d)),onUpdateTodo:s[15]||(s[15]= d=>fe(d)),onDoneTodo:s[16]||(s[16]= d=>me(d))},null,8,["filtering","lists-data"])])])}}});export{Lt as default};
